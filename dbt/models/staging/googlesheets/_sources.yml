version: 2

sources:
  - name: src_googlesheets
    tables:
      - name: assets
        columns:
          - name: asset_name
            data_type: string
          - name: asset_id
            data_type: string
          - name: main_class
            data_type: string
          - name: sub_class
            data_type: string
          - name: sector
            data_type: string
          - name: region
            data_type: string
          - name: sub_region
            data_type: string
          - name: price
            data_type: float64
          - name: currency
            data_type: string
          - name: updated_at
            data_type: date

      - name: strategies
        columns:
          - name: name
            data_type: string
            tests:
              - unique

      - name: transactions
        columns:
          - name: date
            data_type: date
          - name: asset_name
            data_type: string
            tests:
              - relationships:
                  to: source('src_googlesheets', 'assets')
                  field: asset_name
          - name: asset_id
            data_type: string
            tests:
              - relationships:
                  to: source('src_googlesheets', 'assets')
                  field: asset_id
          - name: price
            data_type: float64
          - name: currency
            data_type: string
          - name: amounts
            data_type: int64
          - name: strategy_name
            data_type: string
            tests:
              - relationships:
                  to: source('src_googlesheets', 'strategies')
                  field: name
          - name: strategy_details
            data_type: string
          - name: version
            data_type: string
        tests:
          - dbt_utils.unique_combination_of_columns:
              combination_of_columns:
                - date
                - asset_name
                - price
                - amounts
